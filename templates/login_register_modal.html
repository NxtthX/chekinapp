<!-- login_register_modal.html -->
<div class="modal fade" id="authModal" tabindex="-1" aria-labelledby="authModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="authModalLabel">เข้าสู่ระบบ</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-body">
        <!-- Login Form -->
        <form method="POST" action="/login" id="loginForm">
          <div class="mb-3">
            <label for="login_student_id" class="form-label">รหัสนักศึกษา</label>
            <input type="text" class="form-control" name="student_id" id="login_student_id" required>
          </div>
          <div class="mb-3">
            <label for="login_password" class="form-label">รหัสผ่าน</label>
            <input type="password" class="form-control" name="password" id="login_password" required>
          </div>
          <div class="d-grid gap-2">
            <button type="submit" class="btn btn-primary">เข้าสู่ระบบ</button>
          </div>
        </form>

        <!-- Register Form (hidden by default) -->
        <form method="POST" action="/register" id="registerForm" class="d-none mt-3">
          <div class="mb-3">
            <label for="register_student_id" class="form-label">รหัสนักศึกษา</label>
            <input type="text" class="form-control" name="student_id" id="register_student_id" required>
          </div>
          <div class="mb-3">
            <label for="register_password" class="form-label">รหัสผ่าน</label>
            <input type="password" class="form-control" name="password" id="register_password" required>
          </div>
          <div class="mb-3">
            <label for="confirm_password" class="form-label">ยืนยันรหัสผ่าน</label>
            <input type="password" class="form-control" name="confirm_password" id="confirm_password" required>
          </div>
          <div class="d-grid gap-2">
            <button type="submit" class="btn btn-success">ลงทะเบียน</button>
          </div>
        </form>
      </div>

      <div class="modal-footer justify-content-between">
        <small id="toggleText">ยังไม่มีบัญชี? <a href="#" id="toggleForm">สมัครสมาชิก</a></small>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ปิด</button>
      </div>
    </div>
  </div>
</div>

<script>
  const loginForm = document.getElementById('loginForm');
  const registerForm = document.getElementById('registerForm');
  const toggleForm = document.getElementById('toggleForm');
  const toggleText = document.getElementById('toggleText');
  const modalTitle = document.getElementById('authModalLabel');

  let isLogin = true;

  toggleForm.addEventListener('click', function (e) {
    e.preventDefault();
    isLogin = !isLogin;

    loginForm.classList.toggle('d-none');
    registerForm.classList.toggle('d-none');

    modalTitle.textContent = isLogin ? 'เข้าสู่ระบบ' : 'สมัครสมาชิก';

    toggleText.innerHTML = isLogin
      ? 'ยังไม่มีบัญชี? <a href="#" id="toggleForm">สมัครสมาชิก</a>'
      : 'มีบัญชีอยู่แล้ว? <a href="#" id="toggleForm">เข้าสู่ระบบ</a>';

    // ⚠️ ต้อง re-bind toggleForm เพราะ DOM element ใหม่ถูกสร้างทุกครั้ง
    document.getElementById('toggleForm').addEventListener('click', arguments.callee);
  });
</script>

